<!DOCTYPE html>
<html lang="en">
<head>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Parking</title>
  <!-- tvoj CSS ovdje -->
</head>
<body>
  
  <!-- tvoj HTML kod za parking mjesta -->
  
  <!-- Firebase skripte i konfiguracija -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "TVOJ_API_KEY",
      authDomain: "TVOJ_PROJECT.firebaseapp.com",
      databaseURL: "https://TVOJ_PROJECT.firebaseio.com",
      projectId: "TVOJ_PROJECT",
      storageBucket: "TVOJ_PROJECT.appspot.com",
      messagingSenderId: "TVOJ_SENDER_ID",
      appId: "TVOJ_APP_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
  </script>

  <!-- tvoj JS kod za rezervacije -->
  <script src="script.js"></script>
</body>
</html>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parking ‚Äì Professor Parking</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: url('sssk.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 { margin-top: 20px; font-size: 2.5em; text-shadow: 2px 2px 4px #000; }
    .card {
      background-color: rgba(0,0,0,0.7);
      max-width: 450px;
      margin: 20px auto;
      padding: 20px 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 8px;
      border: none;
      font-size: 1em;
    }
    button {
      background-color: #ffcc00;
      color: #000;
      font-weight: 700;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background-color: #e6b800; }
    #status { margin-top: 15px; font-size: 1em; }
    #qrKod { margin-top: 20px; }
    progress {
      width: 80%;
      height: 20px;
      margin-top: 10px;
      border-radius: 10px;
      overflow: hidden;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    #mjestaZauzeta {
      background-color: rgba(0,0,0,0.6);
      max-width: 450px;
      margin: 10px auto;
      padding: 15px;
      border-radius: 10px;
      display: none;
      text-align: left;
    }
  </style>
</head>
<body>

<h1>üöó Parking ‚Äì Professor Parking</h1>
<h2 style="color: #047730;">
  Free spots: <span id="slobodna">15</span>
</h2>
 
<progress id="progressBar" max="15" value="0"></progress>
<div class="card">
  <form id="uploadForm">
    <label for="korisnikIme">Your name:</label>
    <input type="text" id="korisnikIme" placeholder="Enter your name" required>

    <label for="plate">Enter license plate (e.g., ABC-123):</label>
    <input type="text" id="plate" placeholder="ABC-123" required>

    <label for="vrijemeOd">Time from:</label>
    <input type="time" id="vrijemeOd" required>

    <label for="vrijemeDo">Time to:</label>
    <input type="time" id="vrijemeDo" required>

    <label for="mjestoSelect">Choose spot (1‚Äì15):</label>
    <select id="mjestoSelect" required size="5" style="height:100px; overflow-y: scroll;"></select>

    <button type="submit" id="rezervisiBtn">Reserve spot</button>
    <button type="reset" id="resetBtn">Clear</button>
  </form>
</div>

<div id="status"></div>
<div id="qrKod"></div>

<div class="card">
  <button id="prikaziZauzeta">Show taken spots</button>
  <div id="mjestaZauzeta"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

<script>
  const plateToProfessor = {
    "ABC-123": "Sabahudin Solak",
    "A12-K-456": "Professor Mehic",
    "T99-M-222": "Professor Zukic",
    "SG-123-AB": "Professor Dzafic",
    "K45-O-999": "Professor Imamovic"
  };

  function verifyPairing(plate, name) {
    if (!plateToProfessor[plate]) return { ok: false, msg: "‚ùå This license plate is not registered!" };
    if (plateToProfessor[plate] !== name) return { ok: false, msg: "‚ùå Name does NOT match license plate!" };
    return { ok: true, msg: "‚úî Allowed ‚Äî data matches." };
  }

  const freeSpan = document.getElementById("slobodna");
  const progressBar = document.getElementById("progressBar");
  const qrDiv = document.getElementById("qrKod");
  const statusDiv = document.getElementById("status");
  const placeSelect = document.getElementById("mjestoSelect");
  const showTakenBtn = document.getElementById("prikaziZauzeta");
  const takenPlacesDiv = document.getElementById("mjestaZauzeta");

  let freePlaces = 15;
  let takenPlaces = [];

  function fillPlaces() {
    placeSelect.innerHTML = "";
    for (let i = 1; i <= 15; i++) {
      if (!takenPlaces.some(p => p.place === i)) {
        const option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        placeSelect.appendChild(option);
      }
    }
  }
  fillPlaces();
  freeSpan.textContent = freePlaces;

  function professorAlreadyReserved(plate) {
    return takenPlaces.some(p => p.plate === plate);
  }

  document.getElementById("uploadForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const name = document.getElementById("korisnikIme").value.trim();
    const plate = document.getElementById("plate").value.trim().toUpperCase();
    const timeFrom = document.getElementById("vrijemeOd").value;
    const timeTo = document.getElementById("vrijemeDo").value;
    const selectedPlace = parseInt(placeSelect.value);

    const check = verifyPairing(plate, name);
    if (!check.ok) {
      statusDiv.innerHTML = `<span style="color:red; font-weight:bold;">${check.msg}</span>`;
      return;
    }

    if (professorAlreadyReserved(plate)) {
      statusDiv.innerHTML = `<span style="color:red; font-weight:bold;">
        ‚ùå This professor already reserved a parking spot!
      </span>`;
      return;
    }

    takenPlaces.push({ place: selectedPlace, name, plate, timeFrom, timeTo });

    freePlaces--;
    freeSpan.textContent = freePlaces;
    progressBar.value = 15 - freePlaces;

    statusDiv.innerHTML = `
      <span style="color:lightgreen; font-weight:bold;">‚úî ${name} reserved spot ${selectedPlace}.</span>
      <br>Time: ${timeFrom} - ${timeTo}
    `;

    qrDiv.innerHTML = "";
    const canvas = document.createElement("canvas");
    const qr = new QRious({ element: canvas, size: 200, value: `OPEN_GATE|${plate}` });
    const label = document.createElement("div");
    label.style.color = "#ffcc00";
    label.style.marginBottom = "6px";
    label.textContent = "Scan this QR code to open the gate";
    qrDiv.appendChild(label);
    qrDiv.appendChild(qr.element);

    fillPlaces();
  });

  showTakenBtn.addEventListener("click", function() {
    if (takenPlaces.length === 0) {
      takenPlacesDiv.style.display = "block";
      takenPlacesDiv.innerHTML = "<span>No taken parking spots.</span>";
      return;
    }

    takenPlacesDiv.style.display = "block";
    let html = "<ul>";
    takenPlaces.forEach(p => {
      html += `<li>Spot ${p.place} - ${p.name} (${p.plate}) | ${p.timeFrom} - ${p.timeTo}</li>`;
    });
    html += "</ul>";
    takenPlacesDiv.innerHTML = html;
  });
</script>

</body>
</html>

